#
windows:
#
##############
  binary_sensor:
##############
    - platform: template
      sensors:
        open_windows:
          friendly_name: "Открытые окна"
          value_template: "{{
                          is_state('binary_sensor.0x00158d0006c3cfcc_contact', 'on')
                          or is_state('binary_sensor.0x00158d0006c3ff03_contact', 'on')
                          or is_state('binary_sensor.0x00158d0006c3d02b_contact', 'on')
                          or is_state('binary_sensor.0x00158d0006c415b5_contact', 'on')
                          }}"

##############
  automation: #Автоматизации
##############

    - alias: "windows_open_humidifier_off" # Открыли окно - выключили увлажнители
      trigger:
        platform: state
        entity_id: binary_sensor.open_windows
        to: "on"
        for:
          minutes: 1
      action:
        - service: switch.turn_off
          target:
            entity_id:
              - switch.0x842e14fffefce063_l4 #Увлажнитель в зале
              - switch.0x842e14fffefdac4a_l1 #Увлажнитель в в спальне

    - alias: "windows_open_humidifier_hall_on" # Закрыли окно - включили увлажнители в зале
      trigger:
        platform: state
        entity_id: binary_sensor.open_windows
        to: "off"
        for:
          minutes: 1
      condition:
        - condition: numeric_state
          entity_id: sensor.0x00158d0004186ed6_humidity
          below: 45
      action:
        - service: switch.turn_on
          target:
            entity_id:
              - switch.0x842e14fffefce063_l4 #Увлажнитель в зале
              - switch.0x842e14fffefdac4a_l1 #Увлажнитель в в спальне

    - alias: "windows_open_humidifier_bedroom_on" # Закрыли окно - включили увлажнители в спальне
      trigger:
        platform: state
        entity_id: binary_sensor.open_windows
        to: "off"
        for:
          minutes: 1
      condition:
        - condition: numeric_state
          entity_id: sensor.cleargrass_air_humidity
          below: 45
      action:
        - service: switch.turn_on
          target:
            entity_id:
              - switch.0x842e14fffefdac4a_l1 #Увлажнитель в в спальне